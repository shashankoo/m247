;(function(factory){'use strict'
if(typeof define==='function'&&define.amd){define(['jquery/fileUploader/vendor/blueimp-load-image/js/load-image','jquery/fileUploader/vendor/blueimp-load-image/js/load-image-scale','jquery/fileUploader/vendor/blueimp-load-image/js/load-image-meta'],factory)}else if(typeof module==='object'&&module.exports){factory(require('jquery/fileUploader/vendor/blueimp-load-image/js/load-image'),require('jquery/fileUploader/vendor/blueimp-load-image/js/load-image-scale'),require('jquery/fileUploader/vendor/blueimp-load-image/js/load-image-meta'))}else{factory(window.loadImage)}})(function(loadImage){'use strict'
var originalTransform=loadImage.transform
var originalRequiresCanvas=loadImage.requiresCanvas
var originalRequiresMetaData=loadImage.requiresMetaData
var originalTransformCoordinates=loadImage.transformCoordinates
var originalGetTransformedOptions=loadImage.getTransformedOptions;(function($){if(!$.global.document)return
var testImageURL='data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAA'+'AAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBA'+'QEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQE'+'BAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAIAAwMBEQACEQEDEQH/x'+'ABRAAEAAAAAAAAAAAAAAAAAAAAKEAEBAQADAQEAAAAAAAAAAAAGBQQDCAkCBwEBAAAAAAA'+'AAAAAAAAAAAAAABEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8AG8T9NfSMEVMhQ'+'voP3fFiRZ+MTHDifa/95OFSZU5OzRzxkyejv8ciEfhSceSXGjS8eSdLnZc2HDm4M3BxcXw'+'H/9k='
var img=document.createElement('img')
img.onload=function(){$.orientation=img.width===2&&img.height===3
if($.orientation){var canvas=$.createCanvas(1,1,true)
var ctx=canvas.getContext('2d')
ctx.drawImage(img,1,1,1,1,0,0,1,1)
$.orientationCropBug=ctx.getImageData(0,0,1,1).data.toString()!=='255,255,255,255'}}
img.src=testImageURL})(loadImage)
function requiresCanvasOrientation(options,withMetaData){var orientation=options&&options.orientation
return((orientation===true&&!loadImage.orientation)||(orientation===1&&loadImage.orientation)||((!withMetaData||loadImage.orientation)&&orientation>1&&orientation<9))}
function requiresOrientationChange(orientation,autoOrientation){return(orientation!==autoOrientation&&((orientation===1&&autoOrientation>1&&autoOrientation<9)||(orientation>1&&orientation<9)))}
function requiresRot180(orientation,autoOrientation){if(autoOrientation>1&&autoOrientation<9){switch(orientation){case 2:case 4:return autoOrientation>4
case 5:case 7:return autoOrientation%2===0
case 6:case 8:return(autoOrientation===2||autoOrientation===4||autoOrientation===5||autoOrientation===7)}}
return false}
loadImage.requiresCanvas=function(options){return(requiresCanvasOrientation(options)||originalRequiresCanvas.call(loadImage,options))}
loadImage.requiresMetaData=function(options){return(requiresCanvasOrientation(options,true)||originalRequiresMetaData.call(loadImage,options))}
loadImage.transform=function(img,options,callback,file,data){originalTransform.call(loadImage,img,options,function(img,data){if(data){var autoOrientation=loadImage.orientation&&data.exif&&data.exif.get('Orientation')
if(autoOrientation>4&&autoOrientation<9){var originalWidth=data.originalWidth
var originalHeight=data.originalHeight
data.originalWidth=originalHeight
data.originalHeight=originalWidth}}
callback(img,data)},file,data)}
loadImage.getTransformedOptions=function(img,opts,data){var options=originalGetTransformedOptions.call(loadImage,img,opts)
var exifOrientation=data.exif&&data.exif.get('Orientation')
var orientation=options.orientation
var autoOrientation=loadImage.orientation&&exifOrientation
if(orientation===true)orientation=exifOrientation
if(!requiresOrientationChange(orientation,autoOrientation)){return options}
var top=options.top
var right=options.right
var bottom=options.bottom
var left=options.left
var newOptions={}
for(var i in options){if(Object.prototype.hasOwnProperty.call(options,i)){newOptions[i]=options[i]}}
newOptions.orientation=orientation
if((orientation>4&&!(autoOrientation>4))||(orientation<5&&autoOrientation>4)){newOptions.maxWidth=options.maxHeight
newOptions.maxHeight=options.maxWidth
newOptions.minWidth=options.minHeight
newOptions.minHeight=options.minWidth
newOptions.sourceWidth=options.sourceHeight
newOptions.sourceHeight=options.sourceWidth}
if(autoOrientation>1){switch(autoOrientation){case 2:right=options.left
left=options.right
break
case 3:top=options.bottom
right=options.left
bottom=options.top
left=options.right
break
case 4:top=options.bottom
bottom=options.top
break
case 5:top=options.left
right=options.bottom
bottom=options.right
left=options.top
break
case 6:top=options.left
right=options.top
bottom=options.right
left=options.bottom
break
case 7:top=options.right
right=options.top
bottom=options.left
left=options.bottom
break
case 8:top=options.right
right=options.bottom
bottom=options.left
left=options.top
break}
if(requiresRot180(orientation,autoOrientation)){var tmpTop=top
var tmpRight=right
top=bottom
right=left
bottom=tmpTop
left=tmpRight}}
newOptions.top=top
newOptions.right=right
newOptions.bottom=bottom
newOptions.left=left
switch(orientation){case 2:newOptions.right=left
newOptions.left=right
break
case 3:newOptions.top=bottom
newOptions.right=left
newOptions.bottom=top
newOptions.left=right
break
case 4:newOptions.top=bottom
newOptions.bottom=top
break
case 5:newOptions.top=left
newOptions.right=bottom
newOptions.bottom=right
newOptions.left=top
break
case 6:newOptions.top=right
newOptions.right=bottom
newOptions.bottom=left
newOptions.left=top
break
case 7:newOptions.top=right
newOptions.right=top
newOptions.bottom=left
newOptions.left=bottom
break
case 8:newOptions.top=left
newOptions.right=top
newOptions.bottom=right
newOptions.left=bottom
break}
return newOptions}
loadImage.transformCoordinates=function(canvas,options,data){originalTransformCoordinates.call(loadImage,canvas,options,data)
var orientation=options.orientation
var autoOrientation=loadImage.orientation&&data.exif&&data.exif.get('Orientation')
if(!requiresOrientationChange(orientation,autoOrientation)){return}
var ctx=canvas.getContext('2d')
var width=canvas.width
var height=canvas.height
var sourceWidth=width
var sourceHeight=height
if((orientation>4&&!(autoOrientation>4))||(orientation<5&&autoOrientation>4)){canvas.width=height
canvas.height=width}
if(orientation>4){sourceWidth=height
sourceHeight=width}
switch(autoOrientation){case 2:ctx.translate(sourceWidth,0)
ctx.scale(-1,1)
break
case 3:ctx.translate(sourceWidth,sourceHeight)
ctx.rotate(Math.PI)
break
case 4:ctx.translate(0,sourceHeight)
ctx.scale(1,-1)
break
case 5:ctx.rotate(-0.5*Math.PI)
ctx.scale(-1,1)
break
case 6:ctx.rotate(-0.5*Math.PI)
ctx.translate(-sourceWidth,0)
break
case 7:ctx.rotate(-0.5*Math.PI)
ctx.translate(-sourceWidth,sourceHeight)
ctx.scale(1,-1)
break
case 8:ctx.rotate(0.5*Math.PI)
ctx.translate(0,-sourceHeight)
break}
if(requiresRot180(orientation,autoOrientation)){ctx.translate(sourceWidth,sourceHeight)
ctx.rotate(Math.PI)}
switch(orientation){case 2:ctx.translate(width,0)
ctx.scale(-1,1)
break
case 3:ctx.translate(width,height)
ctx.rotate(Math.PI)
break
case 4:ctx.translate(0,height)
ctx.scale(1,-1)
break
case 5:ctx.rotate(0.5*Math.PI)
ctx.scale(1,-1)
break
case 6:ctx.rotate(0.5*Math.PI)
ctx.translate(0,-height)
break
case 7:ctx.rotate(0.5*Math.PI)
ctx.translate(width,-height)
ctx.scale(-1,1)
break
case 8:ctx.rotate(-0.5*Math.PI)
ctx.translate(-width,0)
break}}})